jQuery(document).ready(function(){var t=jQuery("#be-filters"),n=t.parents(".remodal");if(!t.length)return!0;n.on("submit",function(e){e.preventDefault();var r=t.serialize();return t.find("select.select2").each(function(){var e=jQuery(this),t=e.val();t&&(!Array.isArray(t)||t.length)||(r+="&"+e.attr("name")+"=")}),t.find("input:checkbox").each(function(){var e,t=jQuery(this);!t.prop("checked")&&t.attr("name")&&(e=t.data("unchecked-value")||"",r+="&"+t.attr("name")+"="+e)}),beAddRowsFilter(r),vgseReloadSpreadsheet(!0,vgse_editor_settings.texts.save_changes_before_remove_filter),n.is(":visible")&&n.find(".remodal-cancel").trigger("click"),!1}),jQuery("body").on("vgSheetEditor/beforeIntialLoadingRows",function(){vgseFilters.setLastSessionFilters()})}),jQuery(document).ready(function(){jQuery("body").on("vgSheetEditor:beforeRowsInsert",function(e,t){var r;void 0===window.cellLocatorAlreadyInit&&(window.cellLocatorAlreadyInit=!0,r=document.getElementById("cell-locator-input"))&&Handsontable.dom.addEvent(r,"keyup",function(e){13==e.keyCode&&((e=hot.getPlugin("search").query(this.value)).length?hot.scrollViewportTo(e[0].row,e[0].col,!0):this.value&&alert("Cells not found. Try with another search criteria."),hot.render(),jQuery("#responseConsole .rows-located").length||jQuery("#responseConsole").append('. <span class="rows-located"></span>'),jQuery("#responseConsole .rows-located").text(e.length+" cells located"))}),void 0===window.columnLocatorAlreadyInit&&(window.columnLocatorAlreadyInit=!0,r=document.getElementById("column-locator-input"))&&Handsontable.dom.addEvent(r,"keyup",function(e){var r,n,o;13==e.keyCode&&(e=this.value,(r="number"!=typeof(r=(r="number"!=typeof(r=hot.propToCol(e))?null:r)||hot.propToCol(e.toLowerCase()))?null:r)?o=1:(e=hot.getSettings().colHeaders,r=null,n=this.value.toLowerCase(),o=0,e.forEach(function(e,t){e&&e.indexOf("<input")<0&&-1<e.toLowerCase().indexOf(n)&&(0===o&&(r=t),o++)})),null!==r?hot.selectColumns(r):this.value&&(alert(vgse_editor_settings.texts.column_not_found),vgse_editor_settings.texts.hint_missing_column_on_scroll)&&notification({mensaje:vgse_editor_settings.texts.hint_missing_column_on_scroll,tipo:"info",time:4e4,position:"bottom"}),jQuery("#responseConsole .columns-located").length||jQuery("#responseConsole").append('. <span class="columns-located"></span>'),jQuery("#responseConsole .columns-located").text(o+" columns located"))})})}),jQuery(document).ready(function(){if("undefined"==typeof hot)return!0;jQuery("body").on("keyup",".button-container.run_filters-container .toolbar-submenu input",function(e){13==e.keyCode&&vgseFilters.startQuickSearch(),27==e.keyCode&&vgseFilters.restoreHoverEffectOnSubmenu()}),jQuery("body").on("click",".button-container.run_filters-container .toolbar-submenu .wpse-start-quick-search",function(e){e.preventDefault(),vgseFilters.startQuickSearch()}),document.addEventListener("keydown",function(e){"f"===e.key.toLowerCase()&&e.ctrlKey&&!jQuery(".remodal-is-opened").length&&(e.preventDefault(),hot.deselectCell(),(e=jQuery("#vgse-wrapper .vg-toolbar .button-container.run_filters-container .toolbar-submenu")).css({width:360,display:"block"}),e.find(".wpse-quick-search, .wpse-advanced-filters-value-selector").last().focus().select())})});var vgseFilters={restoreHoverEffectOnSubmenu:function(){jQuery(".button-container.run_filters-container .toolbar-submenu").css({width:"",display:""})},startQuickSearch:function(){jQuery(".button-container.run_filters-container .toolbar-submenu").find("input,select,textarea").each(function(){var e,t,r=jQuery(this).attr("name");r&&(e=jQuery(this).val(),"checkbox"===(t=jQuery("#be-filters").find("input,select,textarea").filter(function(){return jQuery(this).attr("name")===r})).attr("type")?t.prop("checked",jQuery(this).prop("checked")):t.val(e),t.trigger("change"))}),vgseFilters.restoreHoverEffectOnSubmenu(),jQuery("#be-filters").submit()},setLastSessionFilters:function(){vgse_editor_settings.last_session_filters&&(beAddRowsFilter(vgse_editor_settings.last_session_filters),this.fillSearchForm(vgse_editor_settings.last_session_filters),this.fillFavoriteSearchForm(vgse_editor_settings.last_session_filters),window.vgseShowLastSessionFiltersTip=!0,jQuery("body").on("vgSheetEditor:beforeRowsInsert",function(){if(!window.vgseShowLastSessionFiltersTip)return!0;window.vgseShowLastSessionFiltersTip=!1,vgseCustomTooltip(jQuery(".vgse-current-filters a").last(),vgse_editor_settings.texts.last_session_filters_notice,"right",!1,"success")}))},setFiltersSilently:function(e){e&&beAddRowsFilter(e)},fillFavoriteSearchForm:function(e){var a=jQuery(".vg-toolbar .button-container.run_filters-container .toolbar-submenu"),e="string"==typeof e?beParseParams(e):e,l=a;jQuery.each(e,function(e,t){if("meta_query"===e){if(a.find(".advanced-filters-toggle").prop("checked",!0).trigger("change"),"object"==typeof t){var r=(t=vgObjectToArray(t)).length,n=l.find("li.advanced-field:not(.base)").length;if(n<r)for(var o=r-n,i=0;i<o;i++)a.find(".new-advanced-filter").last().trigger("click");var s=0;t.forEach(function(e){var t=l.find(".advanced-field:eq("+s+")");t.find(".wpse-advanced-filters-field-selector").val(e.key).trigger("change"),t.find(".wpse-advanced-filters-operator-selector").val(e.compare).trigger("change"),t.find(".wpse-advanced-filters-value-selector").val(e.value).trigger("change"),s++})}}else e&&("checkbox"===(r=a.find("input,select,textarea").filter(function(){return jQuery(this).attr("name")===e||jQuery(this).attr("name")===e+"[]"})).attr("type")?r.prop("checked",t):("SELECT"===r.prop("tagName")&&r.append('<option value="'+t+'">'+t+"</option>"),r.val(t)),r.trigger("change"))})},fillSearchForm:function(e){var a=jQuery("#be-filters"),e="string"==typeof e?beParseParams(e):e,l=a.find(".advanced-filters-list");jQuery.each(e,function(e,t){if("meta_query"===e){if(a.find(".advanced-filters-toggle").prop("checked",!0).trigger("change"),"object"==typeof t){var r=(t=vgObjectToArray(t)).length,n=l.find("li.advanced-field:not(.base)").length;if(n<r)for(var o=r-n,i=0;i<o;i++)a.find(".new-advanced-filter").last().trigger("click");var s=0;t.forEach(function(e){var t=l.find(".advanced-field:eq("+s+")");t.find(".wpse-advanced-filters-field-selector").val(e.key).trigger("change"),t.find(".wpse-advanced-filters-operator-selector").val(e.compare).trigger("change"),t.find(".wpse-advanced-filters-value-selector").val(e.value).trigger("change"),s++})}}else e&&("checkbox"===(r=a.find("input,select,textarea").filter(function(){return jQuery(this).attr("name")===e||jQuery(this).attr("name")===e+"[]"})).attr("type")?r.prop("checked",t):("SELECT"===r.prop("tagName")&&r.append('<option value="'+t+'">'+t+"</option>"),r.val(t)),r.trigger("change"))})}};